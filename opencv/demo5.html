<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>图像匹配</title>
</head>
<body>
    <img id="whole" src="../img/lena.jpg" alt="">
    <img id="template" src="../img/lena-part.jpg" alt="">
    <canvas id="result" width="512" height="512"></canvas>
    <script src="../lib/opencv.js" type="text/javascript"></script>
    <script>
        window.onload = function(){

            let $whole = document.querySelector('#whole');
            let src = cv.imread($whole);

            let $template = document.querySelector('#template');
            let templ = cv.imread($template);

            let dst = new cv.Mat();
            let mask = new cv.Mat();

            cv.matchTemplate(src, templ, dst, cv.TM_CCOEFF, mask);
            let result = cv.minMaxLoc(dst, mask);
            let maxPoint = result.maxLoc;
            let color = new cv.Scalar(255, 0, 0, 255);
            let point = new cv.Point(maxPoint.x + templ.cols, maxPoint.y + templ.rows);
            cv.rectangle(src, maxPoint, point, color, 2, cv.LINE_8, 0);
            cv.imshow('result', src);
            
            src.delete();
            dst.delete();
            mask.delete();
        }
    </script>
</body>
</html>