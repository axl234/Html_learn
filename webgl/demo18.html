<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>飞行者-模仿</title>
    <script type="text/javascript" src="../lib/three.js"></script>
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <style>
        body{
            padding:0;
            margin:0;
        }
        #world{
            position: absolute;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background: linear-gradient(#e4e0ba, #f7d9aa);
        }
    </style>
</head>
<body>
    <div id="world"></div>
    <script>
        //调色板
        var Colors = {
            red:0xf25346,
            white:0xd8d0d1,
            brown:0x59332e,
            pink:0xF5986E,
            brownDark:0x23190f,
            blue:0x68c3c0
        };
        var renderer;//渲染器
        var width;//页面宽度
        var height;//页面高度

        window.requestAnimFrame = (function() {//如果有变化则可能还需要requestAnimationFrame刷新
            return window.requestAnimationFrame ||
                    window.mozRequestAnimationFrame ||
                    window.webkitRequestAnimationFrame ||
                    window.msRequestAnimationFrame ||
                    window.webkitRequestAnimationFrame;
        })();

        //开始
        function threeStart() {
            initThree();
            initCamera();
            initScene();
            initLight();
            initObject();
            render();
        }

        //根据页面宽度和高度创建渲染器，并添加容器中
        function initThree() {
            width = window.innerWidth;
            height = window.innerHeight;
            renderer = new THREE.WebGLRenderer({
                alpha: true,//开启透明背景色
                antialias : true//开启抗锯齿，但这样会降低性能
            });
            renderer.setSize(width, height);
            renderer.shadowMap.enabled = true;// 打开渲染器的阴影地图
            document.getElementById('world').appendChild(renderer.domElement);
        }
        //创建相机，并设置正方向和中心点
        var camera;
        function initCamera() {
            camera = new THREE.PerspectiveCamera(60, width / height, 1, 10000);
            camera.position.x = 0;
            camera.position.y = 200;
            camera.position.z = 100;
            camera.up.x = 0;//正方向
            camera.up.y = 1;
            camera.up.z = 0;
            camera.lookAt({
                x : 0,
                y : 0,
                z : 0
            });
        }
        //创建场景，后续元素需要加入到场景中才会显示出来
        var scene;
        function initScene() {
            scene = new THREE.Scene();
            scene.fog = new THREE.Fog(0xf7d9aa, 100, 950);// 在场景中添加雾的效果；样式上使用和背景一样的颜色
        }
        //创建光线
        var shadowLight;
        function initLight() {
            shadowLight = new THREE.DirectionalLight(0xffffff, .9);
            shadowLight.position.set(150,350,350);
            shadowLight.castShadow = true;//开启光源投影

            //定义可见域的投射阴影
            shadowLight.shadow.camera.left = -400;
            shadowLight.shadow.camera.right = 400;
            shadowLight.shadow.camera.top = 400;
            shadowLight.shadow.camera.bottom = -400;
            shadowLight.shadow.camera.near = 1;
            shadowLight.shadow.camera.far = 1000;

            //定义阴影的分辨率；虽然分辨率越高越好，但是需要付出更加昂贵的代价维持高性能的表现
            shadowLight.shadow.mapSize.width = 2048;
            shadowLight.shadow.mapSize.height = 2048;

            scene.add(shadowLight);
        }
        //创建展示场景所需的各种元素
        function initObject() {
        }
        //渲染
        function render(){
            renderer.clear();
            renderer.render(scene, camera);
            window.requestAnimFrame(render);
        }

        window.onload = function(){
            threeStart();
        };
    </script>
</body>
</html>